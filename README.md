# ⚽ DS108 - Football Prediction

This project applies machine learning to predict the result of football matches using historical data.

## 📌 Table of Contents

- [Project Structure](#project-structure)
- [Prediction App](#prediction-app)
- [Dataset](#dataset)
- [Methodology](#methodology)
- [Final Model](#final-model)
- [How to Run the Prediction Interface](#how-to-run-the-prediction-interface)
- [License](#license)
- [Credits](#credits)

## 📁 Project Structure:

```
Football-Match-Prediction/
├── requirements.txt            # List of required libraries
├── README.md                   # Project overview and usage guide
├── Project Report.pdf          # Detailed report
├── Project Presentation.pptx   # Presentation slides
├── .gitignore                  # Configuration file to exclude files/folders from Git tracking
├── Source Code/                # Folder containing notebooks and scripts
├── Data and Model/             # Folder containing processed data and trained models
```

**File descriptions**:

- `DataPreprocessing_Rolling.ipynb`: Preprocesses data following the **Medallion Architecture** and generates features using **Rolling Window** techniques.

- `DataPreprocessing_Rolling_Form.ipynb`: Similar to above, but includes additional features based on recent team **Form**.

- `EDA_Visualization.ipynb`: Visualizes data through various charts for analysis and evaluation.

- `Main_Rolling.ipynb`: Trains and tests models using features from **Rolling Window**.

- `Main_Rolling_Form.ipynb`: Trains and tests models using features from both **Rolling Window** and **Form**.

- `TimeSplitValidation.ipynb`: Evaluates model generalization with **TimeSeriesSplit** (walk-forward validation).

---

## ⚙️ Prediction App:

- `predictor.py`: Loads the model and data; defines the prediction function for the user interface.

- `PredictApp.py`: Builds a user interface using **Streamlit**, interacting with `predictor.py`.

---

## 📦 Dataset:

- `FPro_data.csv`: Raw data collected via web crawling from [fbref](https://fbref.com/en/) — corresponds to the **Bronze Layer**.
- `silver_FPro_data.csv`: Cleaned and processed data — reaches **Silver Layer**, generated from preprocessing notebooks.
- `gold_FPro_data_rolling.csv`: Silver data enriched with **Rolling Window features** — represents the **Gold Layer**, created by `DataPreprocessing_Rolling.ipynb`.
- `gold_FPro_data_combination.csv`: Silver data with both **Rolling Window** and **Form** features — also **Gold Layer**, generated by `DataPreprocessing_Rolling_Form.ipynb`.

---

## 🧠 Methodology

The football match outcome prediction pipeline follows the Medallion Architecture comprising three major data layers: Bronze, Silver, and Gold. Each layer is refined and enriched with features through the following steps:

### 1. 📥 Input Data (Bronze Layer)
- Raw data was scraped from website **fbref** and stored in `FPro_data.csv`.
- Includes information such as team names, scores, match dates, etc.

### 2. 🔧 Preprocessing and Standardization (Silver Layer)
- Cleaning data, type conversions, label encoding, and handling missing values.
- Resulting data is stored in `silver_FPro_data.csv`.

### 3. 🪞 Advanced Feature Engineering (Gold Layer)
a. Rolling Statistics
- Applies Rolling Window to compute recent stats: number of wins/draws/losses, goals scored/conceded, etc.
- Implemented in `DataPreprocessing_Rolling.ipynb`, stored in `gold_FPro_data_rolling.csv`.

b. Team Form
- Builds weighted features representing recent team performance (form).
- Combined with rolling stats to form enriched features, saved in `gold_FPro_data_combination.csv`.

### 4. 🤖 Model Training and Evaluation
- Models include: Logistic Regression, Random Forest, XGBoost.
- Evaluated with accuracy, classification report, and confusion matrix.
- Used TimeSeriesSplit (walk-forward validation) to avoid data leakage and ensure temporal integrity.

### 5. ✅ Final Model
- XGBoost model trained with features from Rolling Window + Form achieved the best results.
- Saved as `Final_chosen_model.pkl` for use in the prediction app.

### 6. 🌐 Prediction Interface
- Built with **Streamlit**, allowing users to input home and away teams for match outcome prediction.
- Calls prediction functions defined in `predictor.py` and uses Gold Layer data.

---

## 🤖 Final Model:

 **`Final_chosen_model.pkl`**
 Optimized **XGBoost** model selected as the final predictive model — saved from `Main_Rolling_Form.ipynb`.

---

## 🚀 How to Run the Prediction Interface

1. Install the required library:
   ```
   pip install streamlit
   ```
2. In the terminal, navigate to the folder containing `PredictApp.py` and run:
   ```
   streamlit run PredictApp.py
   ```
3. To exit the app, press `Ctrl + C` in the terminal.

--- 

## 📄 License
📌 Code components are licensed under the MIT License, allowing reuse, modification, and distribution with attribution and no warranty.

📎 Non-code contents are shared under the Creative Commons Attribution-NonCommercial 4.0 International (CC BY-NC 4.0), allowing reuse with attribution for non-commercial purposes.

---

## 👨‍🏫 Credits

Lương Anh Huy - 22520550

Phan Công Minh - 22520884

Instructor: TS. Nguyễn Gia Tuấn Anh - CN. Trần Quốc Khánh

---

